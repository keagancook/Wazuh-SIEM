#### **Executive Summary**
This vulnerability report provides an assessment of network security based on the tools and infrastructure currently in use, including a Nextcloud file server, a Windows desktop computer, Pi-Hole DNS server, and Wazuh SIEM console. Key findings include potential attack vectors, vulnerable applications, and recommendations for remediation.
#### **Scope of Assessment**
The assessment was conducted on a network utilizing the following components
- SIEM: Wazuh
- IDS/IPS: Suricata configured on agents with IPS NFQUEUE, and on Wazuh SIEM with IDS port mirroring
- DNS Filtering: Custom DNS server with Pi-Hole
- File Server: Self-hosted Nextcloud instance

Key logs and alerts were analyzed from Suricata IDS/IPS (eve.json logs), system logs on all devices, and Wazuh alerts.
#### **Findings**
##### 1.0 Nextcloud File Server Vulnerabilities
###### **Vulnerability Scan**
The following table is a compilation of critical application vulnerabilities found by the Wazuh Vulnerability Detection Engine. This list includes all data and includes false positives. 

| ID  | Package Name                   | Package Version                    | Vulnerability Desc.                                                                                                                                                                                                                                                                                                                       | Rec. Action                                                 | Vuln ID        |
| --- | ------------------------------ | ---------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------- | -------------- |
| 1   | docker.io                      | 24.0.7-0ubuntu2~22.04.1            | BuildKit had a vulnerability allowing elevated privilege containers without proper entitlement. Fixed in v0.12.5; avoid untrusted BuildKit frontends.                                                                                                                                                                                     | Uninstall Docker                                            | CVE-2024-23653 |
| 2   | docker.io                      | 24.0.7-0ubuntu2~22.04.1            | BuildKit pre-v0.12.5 allowed malicious frontends or Dockerfiles to delete host files via `RUN --mount`.                                                                                                                                                                                                                                   | Uninstall Docker                                            | CVE-2024-23652 |
| 3   | docker.io                      | 24.0.7-0ubuntu2~22.04.1            | Docker Engine had a regression allowing AuthZ bypass via crafted API requests, fixed in v27.1.1. Avoid AuthZ plugins or limit API access if upgrading isn't possible.                                                                                                                                                                     | Uninstall Docker                                            | CVE-2024-41110 |
| 4   | certifi                        | 2020.6.20                          | Certifi versions prior to 2023.07.22 included e-Tugra root certificates, later removed due to reported security issues in e-Tugra's systems. Update to Certifi 2023.07.22 or later to ensure these certificates are excluded.                                                                                                             | Upgrade certifi                                             | CVE-2023-37920 |
| 5   | thunderbird                    | 1:115.16.0+build2-0ubuntu0.22.04.1 | Memory safety bugs in Firefox <131, ESR <128.3, and Thunderbird <128.3 could enable arbitrary code execution. Update to patched versions.                                                                                                                                                                                                 | Ignore, package is installed but not used on system         | CVE-2024-9402  |
| 6   | thunderbird                    | 1:115.16.0+build2-0ubuntu0.22.04.1 | Compromised processes in Firefox <131, ESR <128.3/115.16, and Thunderbird <131 allowed arbitrary cross-origin page loading. Update immediately.                                                                                                                                                                                           | Ignore                                                      | CVE-2024-9392  |
| 7   | thunderbird                    | 1:115.16.0+build2-0ubuntu0.22.04.1 | Memory safety bugs in Firefox <131, ESR <128.3/115.16, and Thunderbird <131 risk arbitrary code execution. Update to patched versions.                                                                                                                                                                                                    | Ignore                                                      | CVE-2024-9401  |
| 8   | nodejs                         | 12.22.9~dfsg-1ubuntu3.6            | OpenSSL's `SSL_select_next_proto` can cause a buffer overread if called with an empty client protocols list, risking crashes or up to 255 bytes of memory leakage. Issue mainly affects deprecated NPN, not widely used ALPN. Exploitation requires application misconfiguration and is unlikely. Fix pending in future OpenSSL releases. | Ignore, this system does not use NPN and is not vulnerable. | CVE-2024-5535  |
| 9   | cups-filters                   | 1.28.15-0ubuntu1.4                 | CUPS `cups-filters` allows remote command execution via user-controlled `FoomaticRIPCommandLine` in PPD files, especially when combined with CVE-2024-47176.                                                                                                                                                                              | Ignore                                                      | CVE-2024-47177 |
| 10  | node-ip                        | 1.1.5+~1.1.0-1                     | The ip package before 1.1.9 for Node.js might allow SSRF because some IP addresses (such as 0x7f.1) are improperly categorized as globally routable via isPublic.                                                                                                                                                                         | False positive, package version not installed               | CVE-2023-42282 |
| 11  | linux-image-5.15.0-126-generic | 5.15.0-126.136                     | Linux kernel fixed a buffer overflow in `of_modalias()` caused by improper `snprintf()` handling, preventing potential out-of-bounds writes.                                                                                                                                                                                              | False positive, kernel version not installed                | CVE-2024-38541 |
| 12  | linux-image-5.15.0-126-generic | 5.15.0-126.136                     | The Linux kernel fixed a vulnerability in `nf_reject_ip6_tcphdr_put` that could send uninitialized TCP header bits (th->res1) due to improper memory handling. The fix ensures the TCP header is fully cleared using `skb_put_zero()` to prevent garbage data from being transmitted.                                                     | False positive                                              | CVE-2024-47685 |
| 13  | linux-image-5.15.0-127-generic | 5.15.0-127.137                     | The Linux kernel fixed a buffer overflow in `of_modalias()` by adding checks after `snprintf()` and `strlen()` to prevent negative lengths and out-of-bounds writes.                                                                                                                                                                      | Upgrade kernel to version 128                               | CVE-2024-38541 |
| 14  | sssd                           | 2.6.3-1ubuntu3.4                   | FreeBSD's `pam_krb5` without a keytab trusts Kerberos KDC responses blindly, enabling attackers controlling passwords and KDC replies to bypass authentication.                                                                                                                                                                           | Ignore, service is not active                               | CVE-2023-3326  |

###### **Summary**
Confirmed Package Vulnerabilities: 
	-Docker
	-Certifi
	-Linux Kernel 5.15.0-127.137
Ignored Vulnerabilities:
	-Thunderbird 1:115.16.0+build2-0ubuntu0.22.04.1
	-cups-filters 1.28.15-0ubuntu1.4
	-nodejs 12.22.9~dfsg-1ubuntu3.6
	-sshd 2.6.3-1ubuntu3.4
False Positives:
	-Linux Kernel 5.15.0-126.136
	-node IP 1.1.5+~1.1.0-1

##### 2.0 Pi-Hole DNS Server Vulnerabilities
###### **Vulnerability Scan**
The following table is a compilation of critical application vulnerabilities found by the Wazuh Vulnerability Detection Engine. This list includes all data and includes false positives. 

| **ID** | **Package Name** | **Package Version** | **Vulnerability Description**                                                                                                                                                                                                 | **Recommended Action**                                          | **Vulnerability ID** |
| ------ | ---------------- | ------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------- | -------------------- |
| 1      | libzbar0         | 0.23.92-4build2     | ZBar 0.23.90 has a stack-based buffer overflow in `lookup_sequence`, allowing info disclosure or code execution via malicious QR codes.                                                                                       | Ignore, this system does not utilize QR code scan functionality | CVE-2023-40890       |
| 2      | libzbar0         | 0.23.92-4build2     | ZBar 0.23.90 has a heap-based buffer overflow in `qr_reader_match_centers`, enabling info disclosure or code execution via malicious QR codes.                                                                                | Ignore, this system does not utilize QR code scan functionality | CVE-2023-40889       |
| 3      | certifi          | 2020.6.20           | Certifi versions prior to 2023.07.22 included e-Tugra root certificates, later removed due to reported security issues in e-Tugra's systems. Update to Certifi 2023.07.22 or later to ensure these certificates are excluded. | Upgrade certifi                                                 | CVE-2023-37920       |

###### **Summary**
Confirmed Package Vulnerabilities: 
	-Certifi 2020.6.20
Ignored Vulnerabilities:
	-libzbar0 0.23.92-4build2

##### 3.0 Windows Desktop Vulnerabilities
No significant vulnerabilities were detected on this system.
#### **Remediations**
The following table shows the steps taken to remediate confirmed vulnerabilities on all systems. These steps were completed on 12/18/2024 and are now currently patched. 

| Vulnerability ID | Package                         | Remediation Process                                                                                                                                                                                                                                                                                                                                                           |
| ---------------- | ------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| CVE-2024-23653   | docker                          | First, docker was confirmed to not be in use using the command "docker ps -a" "docker volume ls". Both of these commands returned no results, indicated docker was not in use by any other packages. Next, docker was disabled using "systemctl disable docker". To confirm nothing is broken by removing docker, a delay of 2 days will be issued before fully uninstalling. |
| CVE-2024-23652   | docker                          | II                                                                                                                                                                                                                                                                                                                                                                            |
| CVE-2024-41110   | docker                          | II                                                                                                                                                                                                                                                                                                                                                                            |
| CVE-2023-37920   | certifi                         | certifi was upgraded to version 2024.12.14 on the Nextcloud File Server and Pi-Hole DNS Server by issuing the command "pip install --upgrade certifi"                                                                                                                                                                                                                         |
| CVE-2024-38541   | linux kernel 5.15.0-127-generic | Linux kernel was upgraded to version "5.15.0-128-generic" by running "apt update && apt upgrade"                                                                                                                                                                                                                                                                              |

#### **Conclusion**
This assessment has identified key vulnerabilities within the network, including issues with outdated software packages and improperly configured services. The remediation steps detailed in this report have addressed confirmed vulnerabilities on critical systems, such as the Nextcloud server and Pi-Hole DNS server. Notably, the removal of unused services like Docker, combined with the upgrade of packages such as Certifi and the Linux kernel, has significantly improved the security posture of the environment.

Remaining low-priority vulnerabilities, deemed non-critical or false positives, do not currently pose a significant risk. Continued vigilance, routine updates, and regular monitoring using tools like Wazuh SIEM and Suricata IDS will help maintain the integrity and security of the network. Moving forward, implementing stricter configuration controls and periodic security audits will further strengthen the system against emerging threats.
